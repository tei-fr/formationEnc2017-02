<!DOCTYPE HTML>
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>Programme</title>
      <link href="themes/remark-dark.css" rel="stylesheet" media="all" type="text/css">
   </head>
   <body><textarea id="source">
title: Comment la TEI utilise ODD
description: Lou Burnard Consulting,
theme: theme/remark-dark-em.css
name: inverse
layout: true
class: inverse

---
class: center middle



# 07 – Comment la TEI utilise ODD

## Formation TEI | ENC 27 février au 2 mars 2017

.footnote[[Répertoire GitHub](https://github.com/tei-fr/formationEnc2017-02) | [jour1](00-programme.html#jour1) | [jour2](00-programme.html#jour2) | [jour3](00-programme.html#jour3) | [jour4](00-programme.html#jour4)]
![test](images/logo-ecole-nationale-des-chartes.png)

---
template: inverse
class: center middle
name: index


## Comment la TEI utilise ODD

---
lauout:false

# TEI ODD sous le capot

La TEI s’exprime en langage ODD. Ce fut d’ailleurs la raison principale pour laquelle le langage fut inventé

La source TEI P5 (disponible ici ) rassemble&nbsp;:
* 39 fichiers en TEI-XML, dont 25 contiennent un chapitre de documentation en XML-TEI, la plupart définissant un module, par exemple `PH-PrimarySources.xml`

* 778 fichiers en TEI-XML, chacun définissant un élément, une classe, ou une macro
* 29 datatypes (`data.xxxx`) par ex. `teidata.sex.xml`
* 116 classes de type modèle (code&gt;model.xxxx) par ex. `model.biblLike.xml`

* 71 classes de type attribut (`att.xxxx`) par ex. `att.divLike.xml`

* 8 macros (macro.xxxx) par ex. `macro.phraseSeq.xml`

* 555 spécifications d’éléments de `ab.xml` jusqu'à `zone.xml`



Nous allons regarder cela de plus près…

---


# Organisation physique des Guidelines

Il ne faut pas confondre l’organisation physique (en fichiers) avec l’organisation logique (en spécifications, etc.)

* Le fichier `guidelines-XX.xml` est la source des Guidelines pour la langue XX.

* Mis à part quelques liminaires (un TEI Header, la page de titre, etc.), il contient plusieurs lignes comme ceci&nbsp;: `&lt;include xmlns="http://www.w3.org/2001/XInclude" href="Guidelines/en/HD-Header.xml"/&gt; `

* Au sein de chaque chapitre, on trouve des `xInclude` similaires pour les objets définis par ce chapitre.

---


# Organisation logique des Guidelines

* À la fin de chaque chapitre définissant un module, il y a (par convention) un élément `&lt;moduleSpec&gt;` qui rassemble toutes les spécifications référencées par le chapitre pour définir un module

* Ces spécifications sont organisées (par commodité) en `&lt;specGrp&gt;`, qui sont ensuite référencées par un `&lt;specGrpRef&gt;`

* Chaque `&lt;specGrp&gt;` regroupe des spécifications d’objet, indiqué par un `xInclude`

---


# Par exemple…

Cette partie de texte des Guidelines&nbsp;:
![](images/ft-1.png)
est généré à partir des lignes de code suivantes&nbsp;:
```xml
<div >
  <head>Module for Tables, Formulæ, Notated Music, and Graphics</head>
  <p>The module described in this chapter provides the following features:
   <moduleSpec xml:id="DFTFF" ident="figures">
     <desc>Tables, formulæ, notated music, and figures</desc>
     <desc xml:lang="fr">Tableaux, formules et graphiques</desc>
   <!-- ... -->
   </moduleSpec> The selection and combination of modules to form a TEI schema is
   described in <ptr target="#STIN"/>.
   <specGrpRef target="#DFTTAB"/>
   <specGrpRef target="#DFTFOR"/>
   <specGrpRef target="#DFTNTM"/>
   <specGrpRef target="#DFTGRA"/>
  </p>
</div>
```


---


# Les pointers (#DFTTAB etc.) indiquent des specGrp, comme ceci …

```xml
<specGrp  xml:id="DFTTAB" n="Tables">
 &lt;include href="../../Specs/table.xml"/&gt;
 &lt;include href="../../Specs/row.xml"/&gt;
 &lt;include href="../../Specs/cell.xml"/&gt;
 </specGrp>
```

et le xInclude apporte la specification elle meme d’un objet, par ex :

```xml
<elementSpec  module="figures" ident="cell">
   <gloss versionDate="2007-06-12" xml:lang="fr" rend="slide">cellule</gloss>
   <desc versionDate="2005-01-14" xml:lang="en">contains one cell of à table.</desc>
   <!-- ... -->
</elementSpec>
```

---


# De quels types d’objet s’agit-il&nbsp;?

* types de données (`datatypes`)

* classes de modèle (`model classes`)

* classes d’attribut (`attribute classes`)

* `macros`

* … et éléments

Nous allons détailler un exemple de chacun de ces objets …

---


# Une spécification ODD

Ouvrez `teidata.pointer.xml` avec oXygen

Comme tout autre spécification TEI…
* C’est un document XML, à valider contre le schéma spécifié

* Avec deux licences open source

* Il y a une description (`&lt;desc&gt;`) répétée en plusieurs langues, chacune identifiée par `@xml:lang` et avec une `@versionDate`

* La spécification est dotée d’un identifiant, fourni par l’attribut `@ident`), et appartient à un module (`@module`)

* Les remarques (`&lt;remarks&gt;`) sont plurilingues de la même manière que les `&lt;desc&gt;`


---


# Spécification d’un datatype

La signification d'un datatype est indiquée par son `&lt;content&gt;` Cet élément peut contenir :
* soit un élément `&lt;dataRef&gt;` soit un element `&lt;valList&gt;`

* un `&lt;dataRef&gt;` peut indiquer un type de donnée en utilisant un attribut `@name` attribute (type défini par XSD) ou un attribut `@key` (type défini par un élément `&lt;dataSpec&gt;`)

* un `&lt;valList&gt;` fournit une liste de `&lt;valItem&gt;`s, chacun définissant une valeur encodée.


---


# D’autres formes de spécification de datatype

Ouvrez `teidata.certainty.xml` avec oXygen

* Dans ce cas, la liste de valeurs possibles (dans `&lt;content&gt;` ) est fermée

* Les attributs utilisant ce datatype seront limités aux valeurs indiquées

Ouvrez `teidata.probCert.xml` avec oXygen

* Dans ce cas, le `&lt;content&gt;` propose une choix entre deux éléments `&lt;dataRef&gt;`

* Les attributs utilisant ce datatype peuvent avoir soit une des valeurs proposés pour `teidata.certainty`, soit une valeur indiquée par l'element `&lt;content&gt;` de `teidata.probability` (à savoir, un nombre réel entre 0 et 1)

---


# Spécification d’une classe modèle

Ouvrez `model.biblLike.xml` avec oXygen

* La spécification d’une classe modèle n’existe que pour être pointée par d’autres spécifications, donc pas grand chose à voir ici

* Comme ailleurs, on se sert d’un élément `&lt;listRef&gt;` pour regrouper des pointeurs sur la partie des Guidelines où cette classe est décrite.

* Notez l’élément `&lt;classes&gt;`&nbsp;: cette classe est réferencée par ("member of") d’autres classes modèles (`model.inter`, etc.). Une référence à la classe model.inter implique donc une référence à cette classe.

* Pour voir l’effet de cette hiérarchie de classes, regardez [la visualisation de cette spécification](http://www.tei-c.org/release/doc/tei-p5-doc/fr/html/ref-model.biblLike.html)

---


# Spécification d’une classe d’attribut

Ouvrez `att.divLike.xml` avec oXygen

* On vous recommande d’ouvrir la vue Sommaire (Fenêtre-&gt;Afficher la vue-&gt;Sommaire) si besoin est pour visualiser la structure

* La liste des attributs fournis par cette classe est specifiée dans un `&lt;attList&gt;`, qui contient deux `&lt;attDef&gt;` (`@org` et `@uniform`)

* les valeurs disponibles pour un attribut sont spécifiés par un `&lt;datatype&gt;` et éventuellement un `&lt;valList&gt;`, qui rassemblent chaque valeur prévue avec sa définition

* Cette classe est un sous-classe de deux autres (`att.metrical`, et `att.fragmentable`)&nbsp;: si ces classes sont disponibles, les attributs qu’elles fournissent seront donc également disponibles.

---


# Spécification d’un élément

Ouvrez `abstract.xml` avec oXygen

* C’est un élément assez récent (révisé le 2012-12-27) donc il n’y aucune traduction de sa `&lt;desc&gt;` etc. Les parties essentielles d’un `&lt;elementSpec&gt;` sont donc plus évidents.

* Les attributs `@module` et `@ident`

* l’élément `&lt;classes&gt;` qui précise les classes auxquelles cet élément appartient

* l’élément `&lt;content&gt;` qui précise le modèle de contenu de cet élément

* l’élément `&lt;exemplum&gt;` qui contient un exemple de l’usage de l’élément

* facultativement&nbsp;: des remarques (`&lt;remarks&gt;` et des renvois (`&lt;listRef&gt;`)

---


# Les classes TEI

Si on ne comprend pas le système de classes TEI, on aura du mal à comprendre le fonctionnement d’un ODD

* une classe d’attribut comme `att.global` fournit des attributs

* une classe de modélisation comme `model.profileDescPart` regroupe des éléments selon leur sémantique, ou leur possibilités de positionnement&nbsp;:
* model.xxxLike&nbsp;: resemble à un xxx

* model.xxxPart&nbsp;: constitue un xxx


* toute classe peut hériter ses propriétés d’une autre

* on se sert des classes de modélisation surtout dans les définitions de contenu, ce qui permet de les gérer avec une couche d’indirection

---


# Par exemple

```xml
<classes>
   <memberOf key="att.global"/>
   <memberOf key="att.responsibility"/>
   <memberOf key="model.profileDescPart"/>
</classes>
```

* étant membre de `model.profileDescPart`, `&lt;abstract&gt;` peut apparaitre dans `&lt;profileDesc&gt;` parce que le contenu de `&lt;profileDesc&gt;` est
```xml
<classRef  key="model.profileDescPart" maxOccurs="unbounded"/>
```


* en tant que membre de `att.responsibility`, il hérite des attributs `@cert` et `@resp`

* `att.responsibility` lui transmet également l’attribut `@source`, parce qu'elle est memberOf de la classe `att.source`

---


# Définition du contenu d’un élément

L'element `&lt;content&gt;` peut contenir:

* `&lt;elementRef&gt;` : un element

* `&lt;classRef&gt;` une classe d'element

* `&lt;macroRef&gt;` reference a un patron

* `&lt;textNode&gt;` un morceau de texte

* `&lt;anyElement&gt;` : un element non-specifie

Regroupé par :

* `&lt;alternate&gt;` une alternation

* `&lt;sequence&gt;` une séquence

Tous sous contrôle des attributs `@minOccurs` et `@maxOccurs` en ce qui concerne leurs fréquences d'occurence

---


# Par exemple ...

```xml
<content >
  <alternate maxOccurs="unbounded">
    <classRef key="model.pLike"/>
    <classRef key="model.listLike"/>
  </alternate>
</content>
```

« Un ou plusieurs éléments membres des classes `model.pLike` ou bien `model.listLike` »

```xml
<content>
  <sequence maxOccurs="unbounded">
    <classRef key="model.pLike"/>
    <classRef key="model.listLike"/>
  </sequence>
</content>
```

« Une ou plusieurs répétitions d'un élément de la classe `model.pLike` suivi d'un élément de la classe `model.listLike` »

---


# Exemples

l'élément `&lt;egXML&gt;` est utilisé partout dans les Guidelines pour fournir des exemples d'usage directement en XML-TEI. Pour permettre à une validation du contenu de cet élément il est associé avec une autre espace de nommage.

`&lt;p&gt;Par exemple : &lt;egXML &gt; &lt;p&gt;Je ne suis pas un p comme les autres&lt;/p&gt; &lt;/egXML&gt; &lt;/p&gt;`

Oui, c'est une astuce.

---


# Contraintes schematron

* Une spécification d’élément peut aussi contenir un élément `&lt;constraintSpec&gt;` (ou plusieurs), rassemblant des règles exprimées en ISO schematron

* La TEI s’en sert pour exprimer des contraintes additionnelles non exprimables autrement, par exemple des contraintes contextuelles ou concurrentielles

* Le traitement de ces règles nécessite une étape additionnelle dans la validation des documents

* La version courante d’oXygen effectue cela automatiquement, pourvu que votre schéma s'exprime en RELAXNG et vos contraintes s’expriment en ISO schematron.

---


# Exemple de schematron

Ouvrez `span.xml` avec oXygen

* cette spécification comporte plusieurs `&lt;constraintSpec&gt;`, chacun avec son `@ident` et son `@scheme`

* un ou plusieurs `&lt;constraint&gt;` sont possibles

* la contrainte s’exprime en langue ISO schematron, donc dans un autre espace de noms

* par ex. `if @to is supplied on &lt;name/&gt;, @from must be supplied as well` (NB `&lt;name/&gt;` signifie le nom de l’élément qui activera cette règle)

Nous reviendrons sur ce sujet plus loin…

---


# Spécification d’une macro

Ouvrez `macro.phraseSeq.xml` avec oXygen

* Une macro, comme un datatype, fournit une abréviation conventionnelle pour des objets souvent utilisés&nbsp;; dans ce cas, un modèle de contenu.

* L’expansion d’une macro est fournie par un élément `&lt;content&gt;`.

```xml
<content>
 <alternate minOccurs="0" maxOccurs="unbounded">
   <textNode/>
   <classRef key="model.gLike"/>
   <classRef key="model.phrase"/>
   <classRef key="model.global"/>
 </alternate>
</content>
```

« Rien du tout, du texte, ou n’importe combien d’éléments membres de n’importe laquelle des trois classes `model.gLike`, `model.phrase` ou `model.global` »
</textarea><script src="js/remark-0.6.5.min.js" type="text/javascript"></script><script type="text/javascript">
        var hljs = remark.highlighter.engine;
      </script><script src="remark.language.js" type="text/javascript"></script><script type="text/javascript">
        var slideshow = remark.create({
        highlightStyle: 'monokai',
        highlightLanguage: 'remark'
        }) ;
      </script></body>
</html>
